<%= turbo_frame_tag :resource_modal, target: "_top" do %>
  <%= render component("ui/modal").new(title:) do |modal| %>
    <%= form_for @zone, url: @form_url, html: { id: @form_id, data: { controller: stimulus_id, "#{stimulus_id}-kind-value": @zone.kind } } do |f| %>
      <div class="flex flex-col gap-6 pb-4">
        <%= render component("ui/forms/field").text_field(f, :name, class: "required") %>
        <div class="hidden" data-<%= stimulus_id %>-target="countriesWrapper">
          <%= render component("ui/forms/field").select(
            f,
            :country_ids,
            Spree::Country.order(:name).map { |c| [c.name, c.id] },
            object: @zone,
            value: @zone.country_ids,
            multiple: true,
            class: "required",
            "data-#{stimulus_id}-target": "countriesSelect"
          ) %>
        </div>
        <div class="hidden" data-<%= stimulus_id %>-target="statesWrapper">
          <%= render component("ui/forms/field").select(
            f,
            :state_ids,
            Spree::State.includes(:country).order(:name).map { |c| [c.state_with_country, c.id] },
            object: @zone,
            value: @zone.state_ids,
            multiple: true,
            class: "required",
            "data-#{stimulus_id}-target": "statesSelect"
          ) %>
        </div>
        <%= render component("ui/forms/field").text_field(f, :description, class: "required") %>
        <%= render component("ui/forms/field").select(
          f,
          :kind,
          [[t(".kinds.country"), :country], [t(".kinds.state"), :state]],
          object: @zone,
          value: @zone.kind || :state,
          "data-action": "change->#{stimulus_id}#toggleKind"
        ) %>
      </div>
      <% modal.with_actions do %>
        <form method="dialog">
          <%= render component("ui/button").cancel %>
        </form>
        <%= render component("ui/button").submit(resource: @zone, form: @form_id) %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
